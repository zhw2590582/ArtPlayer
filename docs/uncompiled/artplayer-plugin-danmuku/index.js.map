{"mappings":"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","sources":["packages/artplayer-plugin-danmuku/src/index.js","packages/artplayer-plugin-danmuku/src/danmuku.js","packages/artplayer-plugin-danmuku/src/bilibili.js","node_modules/@parcel/transformer-js/src/esmodule-helpers.js","node_modules/@parcel/runtime-js/lib/bundles/runtime-54089e51cb2f5cb0.js","packages/artplayer-plugin-danmuku/src/setting.js","node_modules/@parcel/runtime-js/lib/bundles/runtime-e633bd0642c0f6d8.js","node_modules/@parcel/runtime-js/lib/bundles/runtime-6b6314fb95d0f9c4.js","node_modules/@parcel/runtime-js/lib/bundles/runtime-63e2f0a59f61ce30.js","node_modules/@parcel/runtime-js/lib/bundles/runtime-8c344af6de265517.js","node_modules/@parcel/runtime-js/lib/bundles/runtime-5db94c18a44eaa0a.js","packages/artplayer-plugin-danmuku/src/heatmap.js"],"sourcesContent":["import Danmuku from './danmuku';\nimport Setting from './setting';\nimport heatmap from './heatmap';\n\nexport default function artplayerPluginDanmuku(option) {\n    return (art) => {\n        const danmuku = new Danmuku(art, option);\n\n        let setting = null;\n        if (danmuku.option.mount) {\n            setting = new Setting(art, danmuku);\n        }\n\n        if (option.heatmap) {\n            heatmap(art, danmuku, option.heatmap);\n        }\n\n        return {\n            name: 'artplayerPluginDanmuku',\n            emit: danmuku.emit.bind(danmuku),\n            load: danmuku.load.bind(danmuku),\n            config: danmuku.config.bind(danmuku),\n            hide: danmuku.hide.bind(danmuku),\n            show: danmuku.show.bind(danmuku),\n            reset: danmuku.reset.bind(danmuku),\n            mount: setting?.mount, // 弹幕发射器挂载函数\n            get option() {\n                return danmuku.option;\n            },\n            get isHide() {\n                return danmuku.isHide;\n            },\n            get isStop() {\n                return danmuku.isStop;\n            },\n        };\n    };\n}\n\nif (typeof window !== 'undefined') {\n    window['artplayerPluginDanmuku'] = artplayerPluginDanmuku;\n}\n","import { bilibiliDanmuParseFromUrl } from './bilibili';\nimport workerText from 'bundle-text:./worker';\n\nexport default class Danmuku {\n    constructor(art, option) {\n        const { constructor, template } = art;\n\n        this.utils = constructor.utils; // 工具库\n        this.validator = constructor.validator; // 配置校验器\n        this.$danmuku = template.$danmuku; // 弹幕层容器\n        this.$player = template.$player; // 播放器容器\n\n        this.art = art;\n        this.danmus = []; // 原始弹幕数据\n        this.queue = []; // 实际弹幕队列\n        this.option = {}; // 格式化后的配置项\n        this.$refs = []; // 弹幕DOM节点池\n        this.isStop = false; // 是否停止\n        this.isHide = false; // 是否隐藏\n        this.timer = null; // 定时器\n        this.config(option); // 动态配置\n\n        // 创建 Web Worker, 用于计算弹幕的 top 值\n        this.worker = new Worker(URL.createObjectURL(new Blob([workerText])));\n\n        // 绑定公用事件\n        this.start = this.start.bind(this);\n        this.stop = this.stop.bind(this);\n        this.reset = this.reset.bind(this);\n        this.destroy = this.destroy.bind(this);\n\n        // 监听事件\n        art.on('video:play', this.start);\n        art.on('video:playing', this.start);\n        art.on('video:pause', this.stop);\n        art.on('video:waiting', this.stop);\n        art.on('resize', this.reset);\n        art.on('destroy', this.destroy);\n\n        // 开始加载弹幕\n        this.load();\n    }\n\n    // 默认配置\n    static get option() {\n        return {\n            danmuku: [], // 弹幕数据\n            speed: 5, // 弹幕持续时间\n            margin: ['2%', '25%'], // 弹幕上下边距，支持像素数字和百分比\n            opacity: 1, // 默认弹幕透明度\n            color: '#FFFFFF', // 默认弹幕颜色，可以被单独弹幕项覆盖\n            mode: 0, // 默认弹幕模式: 0: 滚动，1: 顶部，2: 底部\n            fontSize: 25, // 弹幕字体大小，支持像素数字和百分比，不可以被单独弹幕项覆盖\n            filter: () => true, // 从“原始弹幕”到“实际弹幕”的过滤器\n            antiOverlap: true, // 弹幕是否防重叠\n            synchronousPlayback: false, // 是否同步播放速度\n            mount: '.art-controls-center', // 弹幕发射器挂载点, 默认为播放器控制栏中部\n            style: {\n                '--art-theme-color': '#FF0000',\n            }, // 弹幕输入框样式\n            heatmap: false, // 是否开启热力图\n            points: [], // 热力图数据\n            beforeEmit: () => true, // 弹幕输入框发送前的过滤器，支持返回 Promise\n        };\n    }\n\n    // 配置校验\n    static get scheme() {\n        return {\n            danmuku: 'array|function|string',\n            speed: 'number',\n            margin: 'array',\n            opacity: 'number',\n            color: 'string',\n            mode: 'number',\n            fontSize: 'number|string',\n            filter: 'function',\n            antiOverlap: 'boolean',\n            synchronousPlayback: 'boolean',\n            mount: '?htmldivelement|string',\n            style: 'object',\n            heatmap: 'object|boolean',\n            points: 'array',\n            beforeEmit: 'function',\n        };\n    }\n\n    // 初始弹幕样式\n    static get cssText() {\n        return `\n            user-select: none;\n            position: absolute;\n            white-space: pre;\n            pointer-events: none;\n            perspective: 500px;\n            display: inline-block;\n            will-change: transform;\n            font-weight: normal;\n            line-height: 1.125;\n            visibility: hidden;\n            font-family: SimHei, \"Microsoft JhengHei\", Arial, Helvetica, sans-serif;\n            text-shadow: rgb(0, 0, 0) 1px 0px 1px, rgb(0, 0, 0) 0px 1px 1px, rgb(0, 0, 0) 0px -1px 1px, rgb(0, 0, 0) -1px 0px 1px;\n        `;\n    }\n\n    // 是否在移动端使用了自动旋屏，会影响弹幕的left和top值\n    get isRotate() {\n        return this.art.plugins?.autoOrientation?.state;\n    }\n\n    // 计算上空白边距\n    get marginTop() {\n        const { clamp } = this.utils;\n        const value = this.option.margin[0];\n        const { clientHeight } = this.$player;\n\n        if (typeof value === 'number') {\n            return clamp(value, 0, clientHeight);\n        }\n\n        if (typeof value === 'string' && value.endsWith('%')) {\n            const ratio = parseFloat(value) / 100;\n            return clamp(clientHeight * ratio, 0, clientHeight);\n        }\n\n        return Danmuku.option.margin[0];\n    }\n\n    // 计算下空白边距\n    get marginBottom() {\n        const { clamp } = this.utils;\n        const value = this.option.margin[1];\n        const { clientHeight } = this.$player;\n\n        if (typeof value === 'number') {\n            return clamp(value, 0, clientHeight);\n        }\n\n        if (typeof value === 'string' && value.endsWith('%')) {\n            const ratio = parseFloat(value) / 100;\n            return clamp(clientHeight * ratio, 0, clientHeight);\n        }\n\n        return Danmuku.option.margin[1];\n    }\n\n    // 加载弹幕\n    async load() {\n        const { errorHandle } = this.utils;\n\n        try {\n            if (typeof this.option.danmuku === 'function') {\n                this.danmus = await this.option.danmuku();\n            } else if (typeof this.option.danmuku.then === 'function') {\n                this.danmus = await this.option.danmuku;\n            } else if (typeof this.option.danmuku === 'string') {\n                this.danmus = await bilibiliDanmuParseFromUrl(this.option.danmuku);\n            } else {\n                this.danmus = this.option.danmuku;\n            }\n\n            errorHandle(Array.isArray(this.danmus), 'Danmuku need return an array as result');\n\n            this.queue = []; // 清空实际弹幕队列\n            this.$danmuku.innerText = ''; // 清空弹幕层\n            this.danmus.forEach((danmu) => this.emit(danmu)); // 逐个验证原始弹幕并转换为实际弹幕\n            this.art.emit('artplayerPluginDanmuku:loaded', this.queue);\n\n            // TODO: 按时间从小到大排序，用于减少弹幕的遍历次数，待优化...\n            // this.queue = this.queue.sort((a, b) => a.time - b.time);\n        } catch (error) {\n            this.art.emit('artplayerPluginDanmuku:error', error);\n            throw error;\n        }\n\n        return this;\n    }\n\n    // 把原始弹幕转换为实际弹幕\n    emit(danmu) {\n        const { clamp } = this.utils;\n\n        this.validator(danmu, {\n            text: 'string', // 弹幕文本\n            mode: '?number', // 弹幕模式: 0: 滚动，1: 顶部，2: 底部\n            color: '?string', // 弹幕颜色\n            time: '?number', // 弹幕时间\n            border: '?boolean', // 弹幕是否有边框\n            style: '?object', // 弹幕额外样式\n            escape: '?boolean', // 弹幕文本是否转义\n        });\n\n        // 弹幕文本为空则直接忽略\n        if (!danmu.text.trim()) return this;\n\n        // 弹幕模式只能是 0, 1, 2\n        if (![0, 1, 2].includes(danmu.mode)) return this;\n\n        // 自定义弹幕过滤函数\n        if (!this.option.filter(danmu)) return this;\n\n        // 设置弹幕时间，如果没有则默认为当前时间加 0.5 秒\n        if (danmu.time) {\n            danmu.time = clamp(danmu.time, 0, Infinity);\n        } else {\n            danmu.time = this.art.currentTime + 0.5;\n        }\n\n        // 设置弹幕模式，如果没有则默认为全局配置\n        if (danmu.mode === undefined) {\n            danmu.mode = this.option.mode;\n        }\n\n        // 设置弹幕单独样式，如果没有则默认为空对象\n        if (danmu.style === undefined) {\n            danmu.style = {};\n        }\n\n        // 设置弹幕弹幕是否转义，如果没有则默认为 true，即不会显示 HTML 标签\n        if (danmu.escape === undefined) {\n            danmu.escape = true;\n        }\n\n        // 设置弹幕颜色，如果没有则默认为全局配置\n        if (danmu.color === undefined) {\n            danmu.color = this.option.color;\n        }\n\n        // 添加到实际弹幕队列\n        this.queue.push({\n            ...danmu,\n            $state: 'wait', // 弹幕状态\n            $ref: null, // 弹幕 DOM 节点\n            $restTime: 0, // 弹幕剩余时间\n            $lastStartTime: 0, // 弹幕上次开始时间\n        });\n\n        // 弹幕有四个状态：\n        // - wait: 弹幕还未开始显示，没有被添加到 DOM 中\n        // - ready: 弹幕准备好显示，没有被添加到 DOM 中\n        // - emit: 弹幕正在显示，已经被添加到 DOM 中\n        // - stop: 弹幕正在停止显示，已经被添加到 DOM 中\n\n        return this;\n    }\n\n    // 动态配置\n    config(option) {\n        const { clamp } = this.utils;\n\n        this.option = Object.assign({}, Danmuku.option, this.option, option);\n        this.validator(this.option, Danmuku.scheme);\n\n        this.option.speed = clamp(this.option.speed, 1, 10);\n        this.option.opacity = clamp(this.option.opacity, 0, 1);\n        this.option.style = Object.assign({}, Danmuku.option.style, this.option.style);\n\n        // 重新计算弹幕字体大小，需要重新渲染\n        if (option.fontSize) {\n            this.option.fontSize = this.getFontSize(this.option.fontSize);\n            this.reset();\n        }\n\n        this.art.emit('artplayerPluginDanmuku:config', this.option);\n\n        return this;\n    }\n\n    // 计算DOM的left值，受到旋屏影响\n    getLeft($ref) {\n        const rect = $ref.getBoundingClientRect();\n        return this.isRotate ? rect.top : rect.left;\n    }\n\n    // 获取弹幕DOM节点\n    getRef() {\n        const $ref = this.$refs.pop() || document.createElement('div');\n        $ref.style.cssText = Danmuku.cssText;\n\n        // 为了移除用户自定义的样式\n        $ref.className = '';\n        $ref.id = '';\n        return $ref;\n    }\n\n    // 计算弹幕字体大小\n    getFontSize(fontSize) {\n        const { clamp } = this.utils;\n        const { clientHeight } = this.$player;\n\n        if (typeof fontSize === 'number') {\n            return clamp(fontSize, 12, clientHeight);\n        }\n\n        if (typeof fontSize === 'string' && fontSize.endsWith('%')) {\n            const ratio = parseFloat(fontSize) / 100;\n            return clamp(clientHeight * ratio, 12, clientHeight);\n        }\n\n        return Danmuku.option.fontSize;\n    }\n\n    // 计算弹幕的top值\n    postMessage(message = {}) {\n        return new Promise((resolve) => {\n            message.id = Date.now();\n            this.worker.postMessage(message);\n            this.worker.onmessage = (event) => {\n                const { data } = event;\n                if (data.id === message.id) {\n                    resolve(data);\n                }\n            };\n        });\n    }\n\n    // 根据状态，获取弹幕队列中的弹幕\n    filter(state, callback) {\n        return this.queue.filter((danmu) => danmu.$state === state).map(callback);\n    }\n\n    // 获取准备好发送的弹幕：有的是ready状态（如之前因为弹幕太多而暂停发送的弹幕），有的是wait状态\n    getReady() {\n        const { currentTime } = this.art;\n        return this.queue.filter((danmu) => {\n            return (\n                danmu.$state === 'ready' ||\n                (danmu.$state === 'wait' && currentTime + 0.1 >= danmu.time && danmu.time >= currentTime - 0.1)\n            );\n        });\n    }\n\n    // 获取正在发送的弹幕，用于计算下一个弹幕的top值\n    getEmits() {\n        const result = [];\n        const { clientWidth } = this.$player;\n        const clientLeft = this.getLeft(this.$player);\n\n        this.filter('emit', (danmu) => {\n            const top = danmu.$ref.offsetTop;\n            const left = this.getLeft(danmu.$ref) - clientLeft;\n            const height = danmu.$ref.clientHeight;\n            const width = danmu.$ref.clientWidth;\n            const distance = left + width;\n            const right = clientWidth - distance;\n            const speed = distance / danmu.$restTime;\n\n            const emit = {};\n            emit.top = top;\n            emit.left = left;\n            emit.height = height;\n            emit.width = width;\n            emit.right = right;\n            emit.speed = speed;\n            emit.distance = distance;\n            emit.time = danmu.$restTime;\n            emit.mode = danmu.mode;\n\n            result.push(emit);\n        });\n\n        return result;\n    }\n\n    // 重置弹幕到wait状态，回收弹幕DOM节点\n    makeWait(danmu) {\n        danmu.$state = 'wait';\n        if (danmu.$ref) {\n            danmu.$ref.style.cssText = Danmuku.cssText;\n            this.$refs.push(danmu.$ref);\n            danmu.$ref = null;\n        }\n    }\n\n    // 实时更新弹幕\n    update() {\n        const { setStyles } = this.utils;\n\n        this.timer = window.requestAnimationFrame(async () => {\n            if (this.art.playing && !this.isHide) {\n                // 实时计算弹幕的剩余显示时间\n                this.filter('emit', (danmu) => {\n                    const emitTime = (Date.now() - danmu.$lastStartTime) / 1000;\n                    danmu.$restTime -= emitTime;\n                    danmu.$lastStartTime = Date.now();\n                    // 超过时间即重置弹幕\n                    if (danmu.$restTime <= 0) {\n                        this.makeWait(danmu);\n                    }\n                });\n\n                // 获取准备好发送的弹幕\n                const readys = this.getReady(); // 可能包含ready和wait状态的弹幕\n                const { clientWidth, clientHeight } = this.$player;\n\n                for (let index = 0; index < readys.length; index++) {\n                    const danmu = readys[index];\n                    danmu.$ref = this.getRef(); // 获取弹幕DOM节点\n\n                    // 设置弹幕文本\n                    if (danmu.escape) {\n                        danmu.$ref.innerText = danmu.text;\n                    } else {\n                        danmu.$ref.innerHTML = danmu.text;\n                    }\n\n                    // 提前添加到弹幕层中，用于计算top值\n                    this.$danmuku.appendChild(danmu.$ref);\n\n                    // 设置初始弹幕样式\n                    danmu.$ref.style.left = `${clientWidth}px`;\n                    danmu.$ref.style.opacity = this.option.opacity;\n                    danmu.$ref.style.fontSize = `${this.option.fontSize}px`;\n                    danmu.$ref.style.color = danmu.color;\n                    danmu.$ref.style.border = danmu.border ? `1px solid ${danmu.color}` : null;\n                    danmu.$ref.style.backgroundColor = danmu.border ? 'rgb(0 0 0 / 50%)' : null;\n                    danmu.$ref.style.marginLeft = '0px';\n\n                    // 设置单独弹幕样式\n                    setStyles(danmu.$ref, danmu.style);\n\n                    // 记录弹幕时间戳\n                    danmu.$lastStartTime = Date.now();\n\n                    // 计算弹幕剩余时间\n                    danmu.$restTime =\n                        this.option.synchronousPlayback && this.art.playbackRate\n                            ? this.option.speed / Number(this.art.playbackRate)\n                            : this.option.speed;\n\n                    // 计算弹幕的top值\n                    const { top } = await this.postMessage({\n                        target: {\n                            mode: danmu.mode,\n                            height: danmu.$ref.clientHeight,\n                            speed: (clientWidth + danmu.$ref.clientWidth) / danmu.$restTime,\n                        }, // 当前弹幕信息\n                        emits: this.getEmits(), // 正在发送的其它弹幕\n                        antiOverlap: this.option.antiOverlap,\n                        clientWidth: clientWidth,\n                        clientHeight: clientHeight,\n                        marginBottom: this.marginBottom,\n                        marginTop: this.marginTop,\n                    });\n\n                    if (danmu.$ref) {\n                        if (!this.isStop && top !== undefined) {\n                            danmu.$state = 'emit'; // 转换为emit状态\n                            danmu.$ref.style.visibility = 'visible';\n\n                            switch (danmu.mode) {\n                                // 滚动的弹幕\n                                case 0: {\n                                    danmu.$ref.style.top = `${top}px`;\n                                    const translateX = clientWidth + danmu.$ref.clientWidth;\n                                    danmu.$ref.style.transform = `translateX(${-translateX}px)`;\n                                    danmu.$ref.style.transition = `transform ${danmu.$restTime}s linear 0s`;\n                                    break;\n                                }\n                                // 顶部的弹幕\n                                case 1:\n                                // 底部的弹幕\n                                case 2:\n                                    danmu.$ref.style.left = '50%';\n                                    danmu.$ref.style.top = `${top}px`;\n                                    danmu.$ref.style.marginLeft = `-${danmu.$ref.clientWidth / 2}px`;\n                                    break;\n                                default:\n                                    break;\n                            }\n\n                            this.art.emit('artplayerPluginDanmuku:visible', danmu);\n                        } else {\n                            // 假如弹幕已经停止或者没有 top 值，则重置弹幕为ready状态，回收弹幕DOM节点，等待下次发送\n                            danmu.$state = 'ready';\n                            this.$refs.push(danmu.$ref);\n                            danmu.$ref = null;\n                        }\n                    }\n                }\n            }\n\n            // 递归调用\n            if (!this.isStop) {\n                this.update();\n            }\n        });\n        return this;\n    }\n\n    // 继续弹幕\n    continue() {\n        const { clientWidth } = this.$player;\n        this.filter('stop', (danmu) => {\n            danmu.$state = 'emit'; // 转换为emit状态\n            danmu.$lastStartTime = Date.now();\n            switch (danmu.mode) {\n                // 继续滚动的弹幕\n                case 0: {\n                    const translateX = clientWidth + danmu.$ref.clientWidth;\n                    danmu.$ref.style.transform = `translateX(${-translateX}px)`;\n                    danmu.$ref.style.transition = `transform ${danmu.$restTime}s linear 0s`;\n                    break;\n                }\n                default:\n                    break;\n            }\n        });\n\n        return this;\n    }\n\n    // 暂停弹幕\n    suspend() {\n        const { clientWidth } = this.$player;\n        this.filter('emit', (danmu) => {\n            danmu.$state = 'stop'; // 转换为stop状态\n            switch (danmu.mode) {\n                // 停止滚动的弹幕\n                case 0: {\n                    const translateX = clientWidth - (this.getLeft(danmu.$ref) - this.getLeft(this.$player));\n                    danmu.$ref.style.transform = `translateX(${-translateX}px)`;\n                    danmu.$ref.style.transition = 'transform 0s linear 0s';\n                    break;\n                }\n                default:\n                    break;\n            }\n        });\n\n        return this;\n    }\n\n    stop() {\n        this.isStop = true;\n        this.suspend();\n        window.cancelAnimationFrame(this.timer);\n        this.art.emit('artplayerPluginDanmuku:stop');\n        return this;\n    }\n\n    start() {\n        this.isStop = false;\n        this.continue();\n        this.update();\n        this.art.emit('artplayerPluginDanmuku:start');\n        return this;\n    }\n\n    reset() {\n        this.queue.forEach((danmu) => this.makeWait(danmu));\n        return this;\n    }\n\n    show() {\n        this.isHide = false;\n        this.start();\n        this.$danmuku.style.display = '';\n        this.art.emit('artplayerPluginDanmuku:show');\n        return this;\n    }\n\n    hide() {\n        this.isHide = true;\n        this.stop();\n        this.queue.forEach((item) => this.makeWait(item));\n        this.$danmuku.style.display = 'none';\n        this.art.emit('artplayerPluginDanmuku:hide');\n        return this;\n    }\n\n    destroy() {\n        this.stop();\n        this.worker?.terminate?.();\n        this.art.off('video:play', this.start);\n        this.art.off('video:playing', this.start);\n        this.art.off('video:pause', this.stop);\n        this.art.off('video:waiting', this.stop);\n        this.art.off('resize', this.reset);\n        this.art.off('destroy', this.destroy);\n        this.art.emit('artplayerPluginDanmuku:destroy');\n    }\n}\n","export function getMode(key) {\n    switch (key) {\n        case 1:\n        case 2:\n        case 3:\n            return 0; // 滚动\n        case 4:\n            return 2; // 底部\n        case 5:\n            return 1; // 顶部\n        default:\n            return 0;\n    }\n}\n\nexport function bilibiliDanmuParseFromXml(xmlString) {\n    if (typeof xmlString !== 'string') return [];\n    const matches = xmlString.matchAll(/<d (?:.*? )??p=\"(?<p>.+?)\"(?: .*?)?>(?<text>.+?)<\\/d>/gs);\n    return Array.from(matches)\n        .map((match) => {\n            const attr = match.groups.p.split(',');\n            if (attr.length >= 8) {\n                const text = match.groups.text\n                    .trim()\n                    .replaceAll('&quot;', '\"')\n                    .replaceAll('&apos;', \"'\")\n                    .replaceAll('&lt;', '<')\n                    .replaceAll('&gt;', '>')\n                    .replaceAll('&amp;', '&');\n\n                return {\n                    text,\n                    time: Number(attr[0]),\n                    mode: getMode(Number(attr[1])),\n                    fontSize: Number(attr[2]),\n                    color: `#${Number(attr[3]).toString(16)}`,\n                    timestamp: Number(attr[4]),\n                    pool: Number(attr[5]),\n                    userID: attr[6],\n                    rowID: Number(attr[7]),\n                };\n            } else {\n                return null;\n            }\n        })\n        .filter(Boolean);\n}\n\nexport async function bilibiliDanmuParseFromUrl(url) {\n    const res = await fetch(url);\n    const xmlString = await res.text();\n    return bilibiliDanmuParseFromXml(xmlString);\n}\n","exports.interopDefault = function (a) {\n  return a && a.__esModule ? a : {default: a};\n};\n\nexports.defineInteropFlag = function (a) {\n  Object.defineProperty(a, '__esModule', {value: true});\n};\n\nexports.exportAll = function (source, dest) {\n  Object.keys(source).forEach(function (key) {\n    if (key === 'default' || key === '__esModule' || dest.hasOwnProperty(key)) {\n      return;\n    }\n\n    Object.defineProperty(dest, key, {\n      enumerable: true,\n      get: function () {\n        return source[key];\n      },\n    });\n  });\n\n  return dest;\n};\n\nexports.export = function (dest, destName, get) {\n  Object.defineProperty(dest, destName, {\n    enumerable: true,\n    get: get,\n  });\n};\n","module.exports = \"7a58a7689dcfe725\";","import style from 'bundle-text:./style.less';\nimport danmuOn from 'bundle-text:./img/danmu-on.svg';\nimport danmuOff from 'bundle-text:./img/danmu-off.svg';\nimport danmuConfig from 'bundle-text:./img/danmu-config.svg';\nimport danmuStyle from 'bundle-text:./img/danmu-style.svg';\n\nexport default class Setting {\n    constructor(art, danmuku) {\n        return {};\n        const { option } = danmuku;\n        const {\n            template: { $controlsCenter, $player },\n            constructor: {\n                SETTING_ITEM_WIDTH,\n                utils: { removeClass, addClass, append, setStyle, tooltip, query, inverseClass, getIcon },\n            },\n        } = art;\n\n        setStyle($controlsCenter, 'display', 'flex');\n\n        const $danmuOn = getIcon('danmu-on', danmuOn);\n        const $danmuOff = getIcon('danmu-off', danmuOff);\n        const $danmuConfig = getIcon('danmu-config', danmuConfig);\n        const $danmuStyle = getIcon('danmu-style', danmuStyle);\n\n        function addEmitter() {\n            const colors = [\n                '#FE0302',\n                '#FF7204',\n                '#FFAA02',\n                '#FFD302',\n                '#FFFF00',\n                '#A0EE00',\n                '#00CD00',\n                '#019899',\n                '#4266BE',\n                '#89D5FF',\n                '#CC0273',\n                '#222222',\n                '#9B9B9B',\n                '#FFFFFF',\n            ].map((item) => {\n                const isCurrent = option.color === item ? ' art-current' : '';\n                return `<div class=\"art-danmuku-style-panel-color${isCurrent}\" data-color=\"${item}\" style=\"background-color:${item}\"></div>`;\n            });\n\n            const $emitter = append(\n                $controlsCenter,\n                `\n            <div class=\"art-danmuku-emitter\" style=\"max-width: ${option.maxWidth ? `${option.maxWidth}px` : '100%'}\">\n                <div class=\"art-danmuku-left\">\n                    <div class=\"art-danmuku-style\">\n                        <div class=\"art-danmuku-style-panel\">\n                            <div class=\"art-danmuku-style-panel-inner\">\n                                <div class=\"art-danmuku-style-panel-title\">模式</div>\n                                <div class=\"art-danmuku-style-panel-modes\">\n                                    <div class=\"art-danmuku-style-panel-mode art-current\" data-mode=\"0\">滚动</div>\n                                    <div class=\"art-danmuku-style-panel-mode\" data-mode=\"1\">静止</div>\n                                </div>\n                                <div class=\"art-danmuku-style-panel-title\">颜色</div>\n                                <div class=\"art-danmuku-style-panel-colors\">\n                                    ${colors.join('')}\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <input class=\"art-danmuku-input\" maxlength=\"${option.maxLength}\" placeholder=\"发个弹幕见证当下\" />\n                </div>\n                <div class=\"art-danmuku-send\">发送</div>\n            </div>\n            `,\n            );\n\n            const $style = query('.art-danmuku-style', $emitter);\n            const $input = query('.art-danmuku-input', $emitter);\n            const $send = query('.art-danmuku-send', $emitter);\n            const $panel = query('.art-danmuku-style-panel-inner', $emitter);\n            const $modes = query('.art-danmuku-style-panel-modes', $emitter);\n            const $colors = query('.art-danmuku-style-panel-colors', $emitter);\n            const $layer = option.mount || append($player, '<div class=\"art-layer-danmuku-emitter\"></div>');\n\n            if (art.option.backdrop) {\n                addClass($panel, 'art-backdrop-filter');\n            }\n\n            if (option.theme) {\n                addClass($emitter, `art-danmuku-theme-${option.theme}`);\n            }\n\n            let timer = null;\n            let mode = option.mode;\n            let color = option.color;\n            append($style, $danmuStyle);\n\n            function countdown(time) {\n                if (time <= 0) {\n                    timer = null;\n                    $send.innerText = '发送';\n                    removeClass($send, 'art-disabled');\n                } else {\n                    $send.innerText = time;\n                    timer = setTimeout(() => countdown(time - 1), 1000);\n                }\n            }\n\n            function onSend() {\n                const danmu = {\n                    mode,\n                    color,\n                    border: true,\n                    text: $input.value.trim(),\n                };\n\n                if (timer === null && option.beforeEmit(danmu)) {\n                    $input.value = '';\n                    danmuku.emit(danmu);\n                    addClass($send, 'art-disabled');\n                    countdown(option.lockTime);\n                    art.emit('artplayerPluginDanmuku:emit', danmu);\n                }\n            }\n\n            function onResize() {\n                if ($controlsCenter.clientWidth < option.minWidth) {\n                    append($layer, $emitter);\n                    setStyle($layer, 'display', 'flex');\n                    addClass($emitter, 'art-danmuku-mount');\n\n                    if (!option.mount) {\n                        setStyle($player, 'marginBottom', '40px');\n                    }\n                } else {\n                    append($controlsCenter, $emitter);\n                    setStyle($layer, 'display', 'none');\n                    removeClass($emitter, 'art-danmuku-mount');\n\n                    if (!option.mount) {\n                        setStyle($player, 'marginBottom', null);\n                    }\n                }\n            }\n\n            art.proxy($send, 'click', onSend);\n\n            art.proxy($input, 'keypress', (event) => {\n                if (event.key === 'Enter') {\n                    event.preventDefault();\n                    onSend();\n                }\n            });\n\n            art.proxy($modes, 'click', (event) => {\n                const { dataset } = event.target;\n                if (dataset.mode) {\n                    mode = Number(dataset.mode);\n                    inverseClass(event.target, 'art-current');\n                }\n            });\n\n            art.proxy($colors, 'click', (event) => {\n                const { dataset } = event.target;\n                if (dataset.color) {\n                    color = dataset.color;\n                    inverseClass(event.target, 'art-current');\n                }\n            });\n\n            onResize();\n            art.on('resize', () => {\n                if (!art.isInput) {\n                    onResize();\n                }\n            });\n\n            art.on('destroy', () => {\n                if (option.mount && $emitter.parentElement === option.mount) {\n                    option.mount.removeChild($emitter);\n                }\n            });\n        }\n\n        function addControl() {\n            art.controls.add({\n                position: 'right',\n                name: 'danmuku',\n                click: function () {\n                    if (danmuku.isHide) {\n                        danmuku.show();\n                        art.notice.show = '弹幕显示';\n                        setStyle($danmuOn, 'display', null);\n                        setStyle($danmuOff, 'display', 'none');\n                    } else {\n                        danmuku.hide();\n                        art.notice.show = '弹幕隐藏';\n                        setStyle($danmuOn, 'display', 'none');\n                        setStyle($danmuOff, 'display', null);\n                    }\n                },\n                mounted($ref) {\n                    append($ref, $danmuOn);\n                    append($ref, $danmuOff);\n                    tooltip($ref, '弹幕开关');\n                    setStyle($danmuOff, 'display', 'none');\n\n                    art.on('artplayerPluginDanmuku:hide', () => {\n                        setStyle($danmuOn, 'display', 'none');\n                        setStyle($danmuOff, 'display', null);\n                    });\n\n                    art.on('artplayerPluginDanmuku:show', () => {\n                        setStyle($danmuOn, 'display', null);\n                        setStyle($danmuOff, 'display', 'none');\n                    });\n                },\n            });\n        }\n\n        function addSetting() {\n            art.setting.add({\n                width: 260,\n                name: 'danmuku',\n                html: '弹幕设置',\n                tooltip: '更多',\n                icon: $danmuConfig,\n                selector: [\n                    {\n                        width: SETTING_ITEM_WIDTH,\n                        html: '播放速度',\n                        icon: '',\n                        tooltip: '适中',\n                        selector: [\n                            {\n                                html: '极慢',\n                                time: 10,\n                            },\n                            {\n                                html: '较慢',\n                                time: 7.5,\n                            },\n                            {\n                                default: true,\n                                html: '适中',\n                                time: 5,\n                            },\n                            {\n                                html: '较快',\n                                time: 2.5,\n                            },\n                            {\n                                html: '极快',\n                                time: 1,\n                            },\n                        ],\n                        onSelect: function (item) {\n                            danmuku.config({\n                                speed: item.time,\n                            });\n                            return item.html;\n                        },\n                    },\n                    {\n                        width: SETTING_ITEM_WIDTH,\n                        html: '字体大小',\n                        icon: '',\n                        tooltip: '适中',\n                        selector: [\n                            {\n                                html: '极小',\n                                fontSize: '4%',\n                            },\n                            {\n                                html: '较小',\n                                fontSize: '5%',\n                            },\n                            {\n                                default: true,\n                                html: '适中',\n                                fontSize: '6%',\n                            },\n                            {\n                                html: '较大',\n                                fontSize: '7%',\n                            },\n                            {\n                                html: '极大',\n                                fontSize: '8%',\n                            },\n                        ],\n                        onSelect: function (item) {\n                            danmuku.config({\n                                fontSize: item.fontSize,\n                            });\n                            return item.html;\n                        },\n                    },\n                    {\n                        width: SETTING_ITEM_WIDTH,\n                        html: '不透明度',\n                        icon: '',\n                        tooltip: '100%',\n                        selector: [\n                            {\n                                default: true,\n                                opacity: 1,\n                                html: '100%',\n                            },\n                            {\n                                opacity: 0.75,\n                                html: '75%',\n                            },\n                            {\n                                opacity: 0.5,\n                                html: '50%',\n                            },\n                            {\n                                opacity: 0.25,\n                                html: '25%',\n                            },\n                            {\n                                opacity: 0,\n                                html: '0%',\n                            },\n                        ],\n                        onSelect: function (item) {\n                            danmuku.config({\n                                opacity: item.opacity,\n                            });\n                            return item.html;\n                        },\n                    },\n                    {\n                        width: SETTING_ITEM_WIDTH,\n                        html: '显示范围',\n                        icon: '',\n                        tooltip: '3/4',\n                        selector: [\n                            {\n                                html: '1/4',\n                                margin: [10, '75%'],\n                            },\n                            {\n                                html: '半屏',\n                                margin: [10, '50%'],\n                            },\n                            {\n                                default: true,\n                                html: '3/4',\n                                margin: [10, '25%'],\n                            },\n                            {\n                                html: '满屏',\n                                margin: [10, 10],\n                            },\n                        ],\n                        onSelect: function (item) {\n                            danmuku.config({\n                                margin: item.margin,\n                            });\n                            return item.html;\n                        },\n                    },\n                    {\n                        html: '弹幕防重叠',\n                        icon: '',\n                        tooltip: option.antiOverlap ? '开启' : '关闭',\n                        switch: option.antiOverlap,\n                        onSwitch(item) {\n                            danmuku.config({\n                                antiOverlap: !item.switch,\n                            });\n                            item.tooltip = item.switch ? '关闭' : '开启';\n                            return !item.switch;\n                        },\n                    },\n                    {\n                        html: '同步视频速度',\n                        icon: '',\n                        tooltip: option.synchronousPlayback ? '开启' : '关闭',\n                        switch: option.synchronousPlayback,\n                        onSwitch(item) {\n                            danmuku.config({\n                                synchronousPlayback: !item.switch,\n                            });\n                            item.tooltip = item.switch ? '关闭' : '开启';\n                            return !item.switch;\n                        },\n                    },\n                ],\n            });\n        }\n\n        addEmitter();\n        addControl();\n        addSetting();\n    }\n}\n\nif (typeof document !== 'undefined') {\n    if (!document.getElementById('artplayer-plugin-danmuku')) {\n        const $style = document.createElement('style');\n        $style.id = 'artplayer-plugin-danmuku';\n        $style.textContent = style;\n        document.head.appendChild($style);\n    }\n}\n","module.exports = \"c09c1588fb4faeee\";","module.exports = \"ed96d9cba019193e\";","module.exports = \"50e63783768a51c7\";","module.exports = \"6d994b91570c2465\";","module.exports = \"5e37f7b89903ad61\";","const lib = {\n    map(value, inMin, inMax, outMin, outMax) {\n        return ((value - inMin) * (outMax - outMin)) / (inMax - inMin) + outMin;\n    },\n    range(start, end, tick) {\n        const s = Math.round(start / tick) * tick;\n        return Array.from(\n            {\n                length: Math.floor((end - start) / tick),\n            },\n            (v, k) => {\n                return k * tick + s;\n            },\n        );\n    },\n};\n\nconst line = (pointA, pointB) => {\n    const lengthX = pointB[0] - pointA[0];\n    const lengthY = pointB[1] - pointA[1];\n    return {\n        length: Math.sqrt(Math.pow(lengthX, 2) + Math.pow(lengthY, 2)),\n        angle: Math.atan2(lengthY, lengthX),\n    };\n};\n\nexport default function heatmap(art, danmuku, option) {\n    const { query } = art.constructor.utils;\n\n    art.controls.add({\n        name: 'heatmap',\n        position: 'top',\n        html: '',\n        style: {\n            position: 'absolute',\n            top: '-100px',\n            left: '0px',\n            right: '0px',\n            height: '100px',\n            width: '100%',\n            pointerEvents: 'none',\n        },\n        mounted($heatmap) {\n            let $start = null;\n            let $stop = null;\n\n            function update(arg = []) {\n                $start = null;\n                $stop = null;\n                $heatmap.innerHTML = '';\n\n                if (!art.duration || art.option.isLive) return;\n\n                const svg = {\n                    w: $heatmap.offsetWidth,\n                    h: $heatmap.offsetHeight,\n                };\n\n                const options = {\n                    xMin: 0,\n                    xMax: svg.w,\n                    yMin: 0,\n                    yMax: 128,\n                    scale: 0.25,\n                    opacity: 0.2,\n                    minHeight: Math.floor(svg.h * 0.05),\n                    sampling: Math.floor(svg.w / 100),\n                    smoothing: 0.2,\n                    flattening: 0.2,\n                };\n\n                if (typeof option === 'object') {\n                    Object.assign(options, option);\n                }\n\n                let points = [];\n\n                if (Array.isArray(arg) && arg.length) {\n                    points = [...arg];\n                } else {\n                    const gap = art.duration / svg.w;\n                    for (let x = 0; x <= svg.w; x += options.sampling) {\n                        const y = danmuku.danmus.filter(\n                            ({ time }) => time > x * gap && time <= (x + options.sampling) * gap,\n                        ).length;\n                        points.push([x, y]);\n                    }\n                }\n\n                if (points.length === 0) return;\n\n                const lastPoint = points[points.length - 1];\n                const lastX = lastPoint[0];\n                const lastY = lastPoint[1];\n                if (lastX !== svg.w) {\n                    points.push([svg.w, lastY]);\n                }\n\n                const yPoints = points.map((point) => point[1]);\n                const yMin = Math.min(...yPoints);\n                const yMax = Math.max(...yPoints);\n                const yMid = (yMin + yMax) / 2;\n\n                for (let i = 0; i < points.length; i++) {\n                    const point = points[i];\n                    const y = point[1];\n                    point[1] = y * (y > yMid ? 1 + options.scale : 1 - options.scale) + options.minHeight;\n                }\n\n                const controlPoint = (current, previous, next, reverse) => {\n                    const p = previous || current;\n                    const n = next || current;\n                    const o = line(p, n);\n                    const flat = lib.map(Math.cos(o.angle) * options.flattening, 0, 1, 1, 0);\n                    const angle = o.angle * flat + (reverse ? Math.PI : 0);\n                    const length = o.length * options.smoothing;\n                    const x = current[0] + Math.cos(angle) * length;\n                    const y = current[1] + Math.sin(angle) * length;\n                    return [x, y];\n                };\n\n                const bezierCommand = (point, i, a) => {\n                    const cps = controlPoint(a[i - 1], a[i - 2], point);\n                    const cpe = controlPoint(point, a[i - 1], a[i + 1], true);\n                    const close = i === a.length - 1 ? ' z' : '';\n                    return `C ${cps[0]},${cps[1]} ${cpe[0]},${cpe[1]} ${point[0]},${point[1]}${close}`;\n                };\n\n                const pointsPositions = points.map((e) => {\n                    const x = lib.map(e[0], options.xMin, options.xMax, 0, svg.w);\n                    const y = lib.map(e[1], options.yMin, options.yMax, svg.h, 0);\n                    return [x, y];\n                });\n\n                const pathD = pointsPositions.reduce(\n                    (acc, e, i, a) =>\n                        i === 0\n                            ? `M ${a[a.length - 1][0]},${svg.h} L ${e[0]},${svg.h} L ${e[0]},${e[1]}`\n                            : `${acc} ${bezierCommand(e, i, a)}`,\n                    '',\n                );\n\n                $heatmap.innerHTML = `\n                    <svg viewBox=\"0 0 ${svg.w} ${svg.h}\">\n                        <defs>\n                            <linearGradient id=\"heatmap-solids\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">\n                                <stop offset=\"0%\" style=\"stop-color:var(--art-theme);stop-opacity:${options.opacity}\" />\n                                <stop offset=\"0%\" style=\"stop-color:var(--art-theme);stop-opacity:${options.opacity}\" id=\"heatmap-start\" />\n                                <stop offset=\"0%\" style=\"stop-color:var(--art-progress-color);stop-opacity:1\" id=\"heatmap-stop\" />\n                                <stop offset=\"100%\" style=\"stop-color:var(--art-progress-color);stop-opacity:1\" />\n                            </linearGradient>\n                        </defs>\n                        <path fill=\"url(#heatmap-solids)\" d=\"${pathD}\"></path>\n                    </svg>\n                `;\n\n                $start = query('#heatmap-start', $heatmap);\n                $stop = query('#heatmap-stop', $heatmap);\n                $start.setAttribute('offset', `${art.played * 100}%`);\n                $stop.setAttribute('offset', `${art.played * 100}%`);\n            }\n\n            art.on('video:timeupdate', () => {\n                if ($start && $stop) {\n                    $start.setAttribute('offset', `${art.played * 100}%`);\n                    $stop.setAttribute('offset', `${art.played * 100}%`);\n                }\n            });\n\n            art.on('setBar', (type, percentage) => {\n                if ($start && $stop && type === 'played') {\n                    $start.setAttribute('offset', `${percentage * 100}%`);\n                    $stop.setAttribute('offset', `${percentage * 100}%`);\n                }\n            });\n\n            art.on('ready', () => update());\n            art.on('resize', () => update());\n            art.on('artplayerPluginDanmuku:loaded', () => update());\n            art.on('artplayerPluginDanmuku:points', (points) => update(points));\n        },\n    });\n}\n"],"names":[],"version":3,"file":"index.js.map","sourceRoot":"../../../"}