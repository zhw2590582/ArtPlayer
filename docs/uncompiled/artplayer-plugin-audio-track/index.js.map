{"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;6CAAwB;AAAT,SAAS,0BAA0B,MAAM;IACtD,OAAO,CAAC;QACN,MAAM,EAAE,GAAG,EAAE,SAAS,CAAC,EAAE,OAAO,GAAG,EAAE,GAAG;QAExC,IAAI,CAAC,KACH,OAAO;YACL,MAAM;QACR;QAGF,MAAM,QAAQ,IAAI;QAClB,MAAM,GAAG,GAAG;QACZ,MAAM,OAAO,GAAG;QAEhB,SAAS;YACP,IAAI,CAAC,IAAI,KAAK,EACZ;YAEF,MAAM,YAAY,IAAI,WAAW;YACjC,MAAM,aAAa,YAAY;YAE/B,IAAI,KAAK,GAAG,CAAC,MAAM,WAAW,GAAG,cAAc,MAC7C,MAAM,WAAW,GAAG;QAExB;QAEA,IAAI,EAAE,CAAC,QAAQ;YACb;YACA,MAAM,IAAI,GAAG,KAAK,CAAC,CAAC;gBAClB,QAAQ,IAAI,CAAC;YACf;QACF;QAEA,IAAI,EAAE,CAAC,SAAS;YACd,MAAM,KAAK;QACb;QAEA,IAAI,EAAE,CAAC,QAAQ;YACb;QACF;QAEA,IAAI,EAAE,CAAC,oBAAoB;YACzB,IAAI,IAAI,OAAO,EACb;QAEJ;QAEA,IAAI,EAAE,CAAC,oBAAoB;YACzB,MAAM,YAAY,GAAG,IAAI,KAAK,CAAC,YAAY;QAC7C;QAEA,IAAI,EAAE,CAAC,sBAAsB;YAC3B,MAAM,MAAM,GAAG,IAAI,MAAM;YACzB,MAAM,KAAK,GAAG,IAAI,KAAK;QACzB;QAEA,IAAI,EAAE,CAAC,WAAW;YAChB,MAAM,KAAK;YACX,MAAM,GAAG,GAAG;YACZ,MAAM,IAAI;QACZ;QAEA,MAAM,MAAM,GAAG,IAAI,MAAM;QACzB,MAAM,KAAK,GAAG,IAAI,KAAK;QACvB,MAAM,YAAY,GAAG,IAAI,KAAK,EAAE,gBAAgB;QAEhD,OAAO;YACL,MAAM;YACN;QACF;IACF;AACF;AAEA,IAAI,OAAO,WAAW,aACpB,OAAO,yBAAyB,GAAG;;;AC1ErC,QAAQ,cAAc,GAAG,SAAU,CAAC;IAClC,OAAO,KAAK,EAAE,UAAU,GAAG,IAAI;QAAC,SAAS;IAAC;AAC5C;AAEA,QAAQ,iBAAiB,GAAG,SAAU,CAAC;IACrC,OAAO,cAAc,CAAC,GAAG,cAAc;QAAC,OAAO;IAAI;AACrD;AAEA,QAAQ,SAAS,GAAG,SAAU,MAAM,EAAE,IAAI;IACxC,OAAO,IAAI,CAAC,QAAQ,OAAO,CAAC,SAAU,GAAG;QACvC,IACE,QAAQ,aACR,QAAQ,gBACR,OAAO,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,MAE3C;QAGF,OAAO,cAAc,CAAC,MAAM,KAAK;YAC/B,YAAY;YACZ,KAAK;gBACH,OAAO,MAAM,CAAC,IAAI;YACpB;QACF;IACF;IAEA,OAAO;AACT;AAEA,QAAQ,MAAM,GAAG,SAAU,IAAI,EAAE,QAAQ,EAAE,GAAG;IAC5C,OAAO,cAAc,CAAC,MAAM,UAAU;QACpC,YAAY;QACZ,KAAK;IACP;AACF","sources":["packages/artplayer-plugin-audio-track/src/index.js","node_modules/@parcel/transformer-js/src/esmodule-helpers.js"],"sourcesContent":["export default function artplayerPluginAudioTrack(option) {\n  return (art) => {\n    const { url, offset = 0, sync = 0.3 } = option\n\n    if (!url) {\n      return {\n        name: 'artplayerPluginAudioTrack',\n      }\n    }\n\n    const audio = new Audio()\n    audio.src = url\n    audio.preload = 'auto'\n\n    function syncAudio() {\n      if (!art.video)\n        return\n\n      const videoTime = art.currentTime\n      const targetTime = videoTime + offset\n\n      if (Math.abs(audio.currentTime - targetTime) > sync) {\n        audio.currentTime = targetTime\n      }\n    }\n\n    art.on('play', () => {\n      syncAudio()\n      audio.play().catch((err) => {\n        console.warn(err)\n      })\n    })\n\n    art.on('pause', () => {\n      audio.pause()\n    })\n\n    art.on('seek', () => {\n      syncAudio()\n    })\n\n    art.on('video:timeupdate', () => {\n      if (art.playing) {\n        syncAudio()\n      }\n    })\n\n    art.on('video:ratechange', () => {\n      audio.playbackRate = art.video.playbackRate\n    })\n\n    art.on('video:volumechange', () => {\n      audio.volume = art.volume\n      audio.muted = art.muted\n    })\n\n    art.on('destroy', () => {\n      audio.pause()\n      audio.src = ''\n      audio.load()\n    })\n\n    audio.volume = art.volume\n    audio.muted = art.muted\n    audio.playbackRate = art.video?.playbackRate || 1\n\n    return {\n      name: 'artplayerPluginAudioTrack',\n      audio,\n    }\n  }\n}\n\nif (typeof window !== 'undefined') {\n  window.artplayerPluginAudioTrack = artplayerPluginAudioTrack\n}\n","exports.interopDefault = function (a) {\n  return a && a.__esModule ? a : {default: a};\n};\n\nexports.defineInteropFlag = function (a) {\n  Object.defineProperty(a, '__esModule', {value: true});\n};\n\nexports.exportAll = function (source, dest) {\n  Object.keys(source).forEach(function (key) {\n    if (\n      key === 'default' ||\n      key === '__esModule' ||\n      Object.prototype.hasOwnProperty.call(dest, key)\n    ) {\n      return;\n    }\n\n    Object.defineProperty(dest, key, {\n      enumerable: true,\n      get: function () {\n        return source[key];\n      },\n    });\n  });\n\n  return dest;\n};\n\nexports.export = function (dest, destName, get) {\n  Object.defineProperty(dest, destName, {\n    enumerable: true,\n    get: get,\n  });\n};\n"],"names":[],"version":3,"file":"index.js.map","sourceRoot":"../../../"}