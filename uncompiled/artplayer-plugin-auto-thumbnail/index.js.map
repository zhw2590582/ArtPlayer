{"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;6CA0CwB;AA1CxB,SAAS,OAAO,EAAE,GAAG,EAAE,KAAK,EAAE,MAAM,EAAE,EAAE,QAAQ;IAC5C,MAAM,QAAQ,SAAS,aAAa,CAAC;IACrC,MAAM,WAAW,GAAG;IACpB,MAAM,GAAG,GAAG;IAEZ,MAAM,gBAAgB,GAAG;QACrB,MAAM,WAAW,MAAM,QAAQ;QAC/B,MAAM,SAAS,SAAS,aAAa,CAAC;QACtC,MAAM,MAAM,OAAO,UAAU,CAAC;QAC9B,MAAM,SAAS,KAAK,KAAK,CAAC,AAAC,QAAQ,MAAM,WAAW,GAAI,MAAM,UAAU;QAExE,OAAO,KAAK,GAAG,QAAQ;QACvB,OAAO,MAAM,GAAG,SAAS,KAAK,IAAI,CAAC,SAAS;QAE5C,IAAI,cAAc;QAClB,IAAI,UAAU;QAEd,SAAS,YAAY,KAAK;YACtB,OAAO,MAAM,CAAC,CAAC;gBACX,IAAI,eAAe,CAAC;gBACpB,UAAU,IAAI,eAAe,CAAC;gBAE9B,SAAS;oBACL,KAAK;oBACL,QAAQ;gBACZ;YACJ,GAAG;YAEH,IAAI,SAAS,QAAQ;YACrB,MAAM,WAAW,GAAG,AAAC,WAAW,QAAS;YAEzC,MAAM,QAAQ,GAAG;gBACb,IAAI,SAAS,CAAC,OAAO,AAAC,QAAQ,KAAM,OAAO,KAAK,KAAK,CAAC,QAAQ,MAAM,QAAQ,OAAO;gBACnF;gBACA,YAAY,QAAQ;YACxB;QACJ;QAEA,YAAY;IAChB;AACJ;AAEe,SAAS,6BAA6B,MAAM;IACvD,OAAO,OAAO;QACV,IAAI,EAAE,CAAC,wBAAwB;YAC3B,MAAM,MAAM,OAAO,GAAG,IAAI,IAAI,MAAM,CAAC,GAAG;YACxC,MAAM,QAAQ,OAAO,KAAK,IAAI;YAC9B,MAAM,SAAS,OAAO,MAAM,IAAI;YAChC,MAAM,QAAQ,OAAO,KAAK,IAAI;YAC9B,OAAO;gBAAE;gBAAK;gBAAO;YAAO,GAAG,CAAC;gBAC5B,IAAI,UAAU,GAAG;oBACb,GAAG,MAAM;oBACT,QAAQ;oBACR;oBACA;oBACA;gBACJ;YACJ;QACJ;QAEA,OAAO;YACH,MAAM;QACV;IACJ;AACJ;AAEA,IAAI,OAAO,WAAW,aAClB,MAAM,CAAC,+BAA+B,GAAG;;;ACnE7C,QAAQ,cAAc,GAAG,SAAU,CAAC;IAClC,OAAO,KAAK,EAAE,UAAU,GAAG,IAAI;QAAC,SAAS;IAAC;AAC5C;AAEA,QAAQ,iBAAiB,GAAG,SAAU,CAAC;IACrC,OAAO,cAAc,CAAC,GAAG,cAAc;QAAC,OAAO;IAAI;AACrD;AAEA,QAAQ,SAAS,GAAG,SAAU,MAAM,EAAE,IAAI;IACxC,OAAO,IAAI,CAAC,QAAQ,OAAO,CAAC,SAAU,GAAG;QACvC,IACE,QAAQ,aACR,QAAQ,gBACR,OAAO,SAAS,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,MAE3C;QAGF,OAAO,cAAc,CAAC,MAAM,KAAK;YAC/B,YAAY;YACZ,KAAK;gBACH,OAAO,MAAM,CAAC,IAAI;YACpB;QACF;IACF;IAEA,OAAO;AACT;AAEA,QAAQ,MAAM,GAAG,SAAU,IAAI,EAAE,QAAQ,EAAE,GAAG;IAC5C,OAAO,cAAc,CAAC,MAAM,UAAU;QACpC,YAAY;QACZ,KAAK;IACP;AACF","sources":["packages/artplayer-plugin-auto-thumbnail/src/index.js","node_modules/@parcel/transformer-js/src/esmodule-helpers.js"],"sourcesContent":["function create({ url, width, number }, callback) {\n    const video = document.createElement('video');\n    video.crossOrigin = 'anonymous';\n    video.src = url;\n\n    video.onloadedmetadata = () => {\n        const duration = video.duration;\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n        const height = Math.floor((width * video.videoHeight) / video.videoWidth);\n\n        canvas.width = width * 10;\n        canvas.height = height * Math.ceil(number / 10);\n\n        let loadedCount = 0;\n        let blobUrl = null;\n\n        function seekAndDraw(index) {\n            canvas.toBlob((blob) => {\n                URL.revokeObjectURL(blobUrl);\n                blobUrl = URL.createObjectURL(blob);\n\n                callback({\n                    url: blobUrl,\n                    height: height,\n                });\n            }, 'image/jpeg');\n\n            if (index >= number) return;\n            video.currentTime = (duration * index) / number;\n\n            video.onseeked = () => {\n                ctx.drawImage(video, (index % 10) * width, Math.floor(index / 10) * height, width, height);\n                loadedCount++;\n                seekAndDraw(index + 1);\n            };\n        }\n\n        seekAndDraw(0);\n    };\n}\n\nexport default function artplayerPluginAutoThumbnail(option) {\n    return async (art) => {\n        art.on('video:loadedmetadata', () => {\n            const url = option.url || art.option.url;\n            const width = option.width || 160;\n            const number = option.number || 100;\n            const scale = option.scale || 1;\n            create({ url, width, number }, (config) => {\n                art.thumbnails = {\n                    ...config,\n                    column: 10,\n                    number,\n                    width,\n                    scale,\n                };\n            });\n        });\n\n        return {\n            name: 'artplayerPluginAutoThumbnail',\n        };\n    };\n}\n\nif (typeof window !== 'undefined') {\n    window['artplayerPluginAutoThumbnail'] = artplayerPluginAutoThumbnail;\n}\n","exports.interopDefault = function (a) {\n  return a && a.__esModule ? a : {default: a};\n};\n\nexports.defineInteropFlag = function (a) {\n  Object.defineProperty(a, '__esModule', {value: true});\n};\n\nexports.exportAll = function (source, dest) {\n  Object.keys(source).forEach(function (key) {\n    if (\n      key === 'default' ||\n      key === '__esModule' ||\n      Object.prototype.hasOwnProperty.call(dest, key)\n    ) {\n      return;\n    }\n\n    Object.defineProperty(dest, key, {\n      enumerable: true,\n      get: function () {\n        return source[key];\n      },\n    });\n  });\n\n  return dest;\n};\n\nexports.export = function (dest, destName, get) {\n  Object.defineProperty(dest, destName, {\n    enumerable: true,\n    get: get,\n  });\n};\n"],"names":[],"version":3,"file":"index.js.map","sourceRoot":"../../../"}